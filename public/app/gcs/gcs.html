<section id="gcs" style="margin-top: -23px; z-index: -100; overflow: hidden;">
  <div style="
    width: 250px;
    height: 94vh;
    float: left;
    background-color: #eee;
    " ng-show="showActionBar">

    <hgroup style="padding: 10px 5px 5px 5px">
      <h4 style="margin-top: 7px" class="pull-left">Online Vehicles</h4>
    </hgroup>
    <div class="container-fluid" style="margin-top: 40px;">
      <div class="panel panel-default" ng-repeat="drone in drones track by $index" ng-show="telem[drone.name].online">
          <div class="panel-body">
            <a href="" ng-click="selectDrone(drone)">
              <strong>{{drone.name}}</strong> | <strong>{{telem[drone.name].status.State}}</strong>
              <br>In <strong>{{telem[drone.name].mode}}</strong> flight mode <br>
              <em>{{telem[drone.name].status.Armed ? "Armed" : "Disarmed"}}</em> and
              <em>{{telem[drone.name].status.InAir ? "Airborne" : "Grounded"}}</em>
            </a>

            <div ng-show="drone.name == currentDrone.name" ng-init="toggleMode=false; ModeSelect = 'Manual'">
              <hr>
              <button ng-hide="telem[drone.name].status.InAir" ng-click="takeoff(drone.name, 10)" class="btn btn-sm btn-primary">Takeoff</button>
              <button ng-show="telem[drone.name].status.InAir" ng-click="land(drone.name)" class="btn btn-sm btn-primary">Land</button>
              <button ng-hide="telem[drone.name].status.Armed" ng-click="setArming(drone.name, true)" class="btn btn-sm btn-primary">Arm</button>
              <button ng-show="telem[drone.name].status.Armed" ng-click="setArming(drone.name, false)" class="btn btn-sm btn-primary">Disarm</button>
              <button
                ng-click="toggleMode ? setMode(drone.name, ModeSelect): angular.noop(); toggleMode=!toggleMode"
                class="btn btn-sm btn-primary">
                  {{toggleMode ? "Set Mode" : "Mode"}}
              </button>
              <select ng-show="toggleMode" class="form-control" ng-model="ModeSelect">
                <option value="Manual">Manual</option>
                <option value="Altitude">Altitude</option>
                <option value="Position">Position</option>
                <option value="Takeoff">Takeoff</option>
                <option value="Hold">Hold</option>
                <option value="Land">Land</option>
              </select>
            </div>
          </div>
      </div>
    </div>
  </div>
  <button style="position: fixed; margin-top: 80px; margin-left: 10px; z-index: 100" class="btn btn-sm btn-primary pull-right" ng-click="toggleActionBar()">
    <span class="glyphicon" ng-class="mapArrow"></span>
  </button>

  <div id="telemetryPane" ng-show="currentDrone"
    style="
      position: fixed;
      right: 0px;
      z-index: 2000;
      width: 150px;
      margin: 15px 15px 15px 15px;
    ">
    <h3>{{currentDrone.name}}</h3>
    <div class="panel panel-default">
      <div class="panel-body">
        <p>
          <strong>Roll:</strong>{{currentDroneTelem.attitude.Roll | number:'2'}}<br>
          <strong>Pitch:</strong> {{currentDroneTelem.attitude.Pitch | number:'2'}}<br>
          <strong>Heading:</strong> {{currentDroneTelem.attitude.Yaw | number:'2'}}
        </p>
      </div>
    </div>

    <div class="panel panel-default">
      <div class="panel-body">
        <p>
          <strong>Speed:</strong> {{currentDroneTelem.rates.Groundspeed | number:'2'}}<br>
          <strong>Throttle:</strong> {{currentDroneTelem.rates.Throttle | number:'2'}}<br>
          <strong>Climb:</strong> {{currentDroneTelem.rates.Climb | number:'2'}}<br>
          <strong>Altitude:</strong> {{currentDroneTelem.position.Altitude | number:'2'}}<br>
        </p>
      </div>
    </div>
  </div>

  <leaflet id="groundcontrol" defaults="defaults" ng-style="mapOffset" style="
    width: 100%;
    height: 94vh;
    float: right;
    position: fixed;
    "></leaflet>

    <script type="text/ng-template" id="gotoModal.html">
      <div class="modal-header">
        <h3 class="modal-title" id="modal-title">Send vehicle {{target.name}} here?</h3>
      </div>
      <div class="modal-body" id="modal-body">
        Location coordinates: <strong>({{target.lat | number:'5'}}, {{target.lon | number:'5'}})</strong><br>
        Approximate travel time: <strong>
          <span ng-show="target.time > 3600000">{{target.time | date:'h'}} hours,</span>
          <span ng-show="target.time > 60000">{{target.time | date:'m'}} minutes</span>,
          and {{target.time | date:'s'}} seconds.</strong><br>

        Distance: <strong>{{target.dist | number:'2'}} miles.</strong>
      </div>
      <div class="modal-footer">
        <button class="btn btn-primary" type="button" ng-click="ok()">Confirm</button>
        <button class="btn btn-warning" type="button" ng-click="cancel()">Cancel</button>
      </div>
    </script>
</section>
